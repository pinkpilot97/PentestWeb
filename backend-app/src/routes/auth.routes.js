import {Router} from 'express'
import {login, reset, profile, changePass, gentTokenReset, verify} from "../controllers/auth.controller.js";
import { authorized } from '../middlewares/validateToken.js';
import { validateSchema } from '../middlewares/validator.middleware.js';
import { loginSchema, resetPasswordTokenSchema, changePasswordSchema } from '../schemas/auth.schema.js';


const router = Router()

router.post('/api/login',validateSchema(loginSchema), login);
router.post('/api/verify', verify);
router.post('/api/reset/token', gentTokenReset);
router.post('/api/reset/password', validateSchema(resetPasswordTokenSchema), reset);
router.get('/api/profile', authorized, profile);
router.post('/api/change-pass/:id',validateSchema(changePasswordSchema), authorized, changePass)

export default router